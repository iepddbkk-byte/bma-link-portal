<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - BMA</title>
    
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap"></noscript>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root {
            --bma-green: #00963C;
            --bma-green-hover: #007a30;
            --bma-green-light: #e8f5e9;
            --button-red: #dc3545;
            --button-red-hover: #c82333;
            --button-blue: #007bff;
            --button-blue-hover: #0056b3;
            --button-yellow: #ffc107;
            --button-yellow-hover: #e0a800;
            --button-gray: #6c757d;
            --light-gray: #f8f9fa;
            --text-color: #2c3e50;
            --border-color: #e0e0e0;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 16px rgba(0,0,0,0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body { 
            font-family: 'Kanit', Arial, sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header Styles */
        .main-header {
            background: white;
            padding: 15px 20px;
            box-shadow: var(--shadow-md);
            border-bottom: 4px solid var(--bma-green);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo-container { 
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-container img {
            height: 60px;
            transition: transform 0.3s;
        }

        .logo-container img:hover {
            transform: scale(1.05);
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--bma-green);
            display: none;
        }

        .navigation {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .user-greeting {
            font-size: 0.95rem;
            color: var(--text-color);
            font-weight: 500;
            padding: 8px 16px;
            background: var(--bma-green-light);
            border-radius: 20px;
            display: none;
            white-space: nowrap;
        }

        .mobile-menu-toggle {
            display: none;
            background: var(--bma-green);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Button Styles */
        button, .btn, a.btn-edit { 
            font-family: 'Kanit', Arial, sans-serif; 
            color: white; 
            border: none; 
            padding: 10px 16px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.95rem; 
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
            box-shadow: var(--shadow-sm);
            text-decoration: none !important;
            display: inline-block;
        }

        button:hover, .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-add { 
            background: linear-gradient(135deg, var(--bma-green), var(--bma-green-hover));
            font-size: 1.05rem;
            padding: 12px 24px;
            margin-bottom: 15px;
        }

        .btn-home { background: linear-gradient(135deg, var(--button-blue), var(--button-blue-hover)); }
        .btn-analytics { background: linear-gradient(135deg, var(--button-blue), var(--button-blue-hover)); }
        .btn-admin { background: linear-gradient(135deg, var(--button-yellow), var(--button-yellow-hover)); color: #212529 !important; }
        .btn-feedback { background: linear-gradient(135deg, var(--button-gray), #5a6268); }
        .btn-logout { background: linear-gradient(135deg, var(--button-red), var(--button-red-hover)); }
        .btn-dashboard { background: linear-gradient(135deg, var(--bma-green), var(--bma-green-hover)); }
        .btn-profile { background: linear-gradient(135deg, var(--button-yellow), var(--button-yellow-hover)); color: #212529 !important; }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-edit { 
            background: linear-gradient(135deg, var(--button-yellow), var(--button-yellow-hover)); 
            color: #212529 !important;
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-delete { 
            background: linear-gradient(135deg, var(--button-red), var(--button-red-hover));
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 20px;
        }

        .content-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1, h2 { 
            color: var(--text-color);
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--bma-green);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Search Container */
        .search-container {
            margin: 25px 0;
            position: relative;
        }

        #searchInput {
            width: 100%;
            padding: 15px 20px 15px 50px;
            font-family: 'Kanit', sans-serif;
            font-size: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            transition: all 0.3s;
            background: white;
        }

        #searchInput:focus {
            outline: none;
            border-color: var(--bma-green);
            box-shadow: 0 0 0 4px var(--bma-green-light);
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--button-gray);
            font-size: 1.2rem;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            margin-top: 20px;
        }

        table { 
            width: 100%; 
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.9rem;
            background: white;
        }

        th, td { 
            padding: 14px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th { 
            background: linear-gradient(135deg, var(--bma-green), var(--bma-green-hover));
            color: white;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
        }

        th:first-child {
            border-top-left-radius: 12px;
        }

        th:last-child {
            border-top-right-radius: 12px;
        }

        tbody tr {
            transition: all 0.3s;
        }

        tbody tr:hover {
            background: var(--bma-green-light);
            transform: scale(1.01);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        table tbody td:nth-child(3),
        table tbody td:nth-child(4) {
            text-align: center;
        }

        a { 
            color: var(--bma-green);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        a:hover { 
            color: var(--bma-green-hover);
            text-decoration: underline;
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-ok { background: #d4edda; color: #155724; }
        .status-blocked { background: #cce5ff; color: #004085; }
        .status-error { background: #f8d7da; color: #721c24; }
        .status-unknown { background: #e2e3e5; color: #383d41; }
        .status-active { background: #d4edda; color: #155724; }
        .status-updating { background: #fff3cd; color: #856404; }
        .status-inactive { background: #f8d7da; color: #721c24; }

        /* Sort Buttons */
        .sort-buttons {
            margin-top: 8px;
            display: flex;
            gap: 5px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sort-buttons button {
            font-size: 0.75rem;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .sort-buttons button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: none;
        }

        /* Pagination */
        .pagination-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-top: 25px;
            border-top: 2px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
        }

        .pagination-items {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .pagination-items select {
            font-family: 'Kanit', sans-serif;
            padding: 8px 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination-items select:focus {
            outline: none;
            border-color: var(--bma-green);
        }

        .pagination-nav {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-nav button {
            background: var(--button-gray);
            min-width: 40px;
            padding: 8px 12px;
        }

        .pagination-nav button:hover {
            background: #5a6268;
        }

        .pagination-nav button:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .pagination-nav span {
            font-weight: 500;
            padding: 0 10px;
            white-space: nowrap;
        }

        /* Footer */
        .main-footer {
            background: linear-gradient(135deg, var(--bma-green), var(--bma-green-hover));
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 50px;
            box-shadow: var(--shadow-lg);
        }

        .main-footer p {
            margin: 8px 0;
            font-size: 0.95rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }

            .navigation {
                display: none;
                width: 100%;
                flex-direction: column;
                background: white;
                padding: 15px;
                border-radius: 12px;
                margin-top: 10px;
                box-shadow: var(--shadow-md);
            }

            .navigation.active {
                display: flex;
            }

            .navigation button {
                width: 100%;
                justify-content: center;
            }

            .user-greeting {
                display: none !important;
            }

            .logo-text {
                display: none;
            }

            h1, h2 {
                font-size: 1.5rem;
            }

            .content-card {
                padding: 20px 15px;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 10px 8px;
            }

            .pagination-controls {
                justify-content: center;
            }

            .pagination-items,
            .pagination-nav {
                width: 100%;
                justify-content: center;
            }

            /* Hide some columns on mobile */
            th:nth-child(2),
            td:nth-child(2),
            th:nth-child(7),
            td:nth-child(7),
            th:nth-child(9),
            td:nth-child(9) {
                display: none;
            }

            .action-buttons {
                flex-direction: column;
                gap: 5px;
            }

            .btn-edit, .btn-delete {
                width: 100%;
                text-align: center;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                padding: 20px 15px;
            }

            .logo-text {
                display: block;
            }

            .user-greeting {
                display: block;
            }
        }

        @media (min-width: 1025px) {
            .logo-text {
                display: block;
            }

            .user-greeting {
                display: block;
            }
        }

        /* Smooth Scroll */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
    
    <header class="main-header">
        <div class="header-container">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='pictures/logo.png') }}" alt="BMA Logo">
                <div class="logo-text">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡∏¥‡∏á‡∏Ñ‡πå BMA</div>
            </div>
			
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>
        
            <div class="navigation" id="mainNavigation">
                {% if session.get('logged_in') %}
                    <span>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, {{ session.name }}!</span>
                    
                    {% if session.get('level') == 'Admin' %}
                    <a href="{{ url_for('admin_panel') }}">
                        <button type="button" class="btn-admin">üëë Admin Panel</button>
                    </a>
                    {% endif %}
                    <a href="{{ url_for('analytics_page') }}">
                        <button type="button" class="btn-analytics">üìä Analytics</button>
                    </a>
                    <a href="{{ url_for('dashboard') }}">
                        <button type="button" class="btn-dashboard">üñ•Ô∏è Dashboard</button>
                    </a>
                    <a href="{{ url_for('feedback_page') }}">
                        <button type="button" class="btn-feedback">üìù ‡∏™‡πà‡∏á Feedback</button>
                    </a>
                    <a href="{{ url_for('profile_page') }}">
                        <button type="button" class="btn-profile">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
                    </a>
                    <a href="{{ url_for('logout') }}">
                        <button type="button" class="btn-logout">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </a>
                {% else %}
                    <a href="{{ url_for('login_page') }}"><button>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</button></a>
                {% endif %}
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="content-card">
            <h2>üñ•Ô∏è Dashboard ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏¥‡∏á‡∏Ñ‡πå</h2>
            
            <a href="{{ url_for('add_link_page') }}"><button class="btn-add">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà</button></a>

            <div class="search-container">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏∏‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå (‡∏ä‡∏∑‡πà‡∏≠, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞, ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó, ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô, ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á)...">
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>
                                üîó ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Ñ‡πå
                                <div class="sort-buttons">
                                    <button onclick="sortTable(0, 'asc')">A-Z (‡∏Å-‡∏Æ)</button>
                                    <button onclick="sortTable(0, 'desc')">Z-A (‡∏Æ-‡∏Å)</button>
                                </div>
                            </th>
                            <th>üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                            <th>üö¶ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡∏¥‡∏á‡∏Ñ‡πå</th> 
                            <th>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th>
                            <th>üìÇ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                            <th>üè¢ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                            <th>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                            
                            <th>üë§ ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á</th>
                            
                            <th>üóìÔ∏è ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</th>
                            <th>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
            <tbody id="linkTableBody">
                
                {% for link in links %}
                <tr>
                    <td>
                        {% if link.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ == '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' %}
                            <a href="{{ link.URL }}" target="_blank">{{ link.‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå }}</a>
                        {% else %}
                            {{ link.‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå }}
                        {% endif %}
                    </td>
                    <td>{{ link.‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ }}</td>
                    
                    <td>
                        {% if link.LinkStatus == 'OK' %}
                            <span style="color: green; font-weight: 500;">üü¢ ‡∏õ‡∏Å‡∏ï‡∏¥</span>
                        {% elif link.LinkStatus == '403 Blocked' %}
                            <span style="color: #007bff; font-weight: 500;">üîµ ‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å</span>
                        {% elif link.LinkStatus %}
                            <span style="color: red; font-weight: 500;">üî¥ {{ link.LinkStatus }}</span>
                        {% else %}
                            <span style="color: gray;">‚ö™ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö)</span>
                        {% endif %}
                    </td>

                    <td>
                        {% if link.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ == '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' %}
                            <span style="color: green;">‚óè ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                        {% elif link.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ == '‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á' %}
                            <span style="color: #FFC107;">‚óè ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</span>
                        {% elif link.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ == '‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' %}
                            <span style="color: red;">‚óè ‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                        {% else %}
                            {{ link.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ }}
                        {% endif %}
                    </td>
                    <td>{{ link.‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó }}</td>
                    <td>{{ link.‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô }}</td>
                    <td>{{ link.‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ }}</td>
                    
                    <td>
                        <a href="{{ url_for('view_profile', username=link.CreatorUsername) }}" target="_blank" style="font-weight: 500; color: var(--text-color); text-decoration: none;" onmouseover="this.style.color='var(--bma-green)'" onmouseout="this.style.color='var(--text-color)'">
                            {{ link.CreatorUsername }}
                        </a>
                    </td>

                    <td>{{ link.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï.split(' ')[0] }}</td>
                    
                    <td>
                        <div class="action-buttons">
                        {% if session.level == 'Admin' or (session.level == 'Users' and link.CreatorUsername == session.username) %}
                            <form action="{{ url_for('delete_link_action', link_id=link.ID) }}" method="POST" class="delete-form">
                                <button type="submit" class="btn-delete">üÖæÔ∏è ‡∏•‡∏ö</button>
                            </form>
                            <a href="{{ url_for('edit_link_page', link_id=link.ID) }}" class="btn-edit">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
                        {% else %}
                            <i style="font-size: 0.9em; color: #6c757d;">(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå)</i>
                        {% endif %}
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr id="noDataRow">
                    <td colspan="10" style="text-align: center;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏¥‡∏á‡∏Ñ‡πå</td>
                </tr>
                {% endfor %}
            </tbody>
                </table>
            </div>

            <div class="pagination-controls">
                <div class="pagination-items">
                    <span>‡πÅ‡∏™‡∏î‡∏á: </span>
                    <select id="itemsPerPage">
                        <option value="10">10</option>
                        <option value="20" selected>20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="99999">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                    </select>
                    <span>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                </div>
                <div class="pagination-nav">
                    <button id="btnFirst" title="‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">¬´</button>
                    <button id="btnPrev" title="‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">‚Äπ</button>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ <span id="currentPage">1</span> / <span id="totalPages">1</span></span>
                    <button id="btnNext" title="‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">‚Ä∫</button>
                    <button id="btnLast" title="‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢">¬ª</button>
                </div>
            </div>
        </div>
    </div> 
    
    <footer class="main-footer">
        <p><strong>‡∏Å‡∏≠‡∏á‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á</strong></p>
        <p>‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</p>
        <p>üìû ‡πÇ‡∏ó‡∏£ 0-2221-2141-69 ‡∏ï‡πà‡∏≠ 1513</p>
        <p style="margin-top: 15px; font-size: 0.85rem; opacity: 0.9;">¬© 2024 Bangkok Metropolitan Administration. All rights reserved.</p>
    </footer>

    <script>
        // 1. ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        let allTableRows = []; 
        let currentPage = 1;
        let totalPages = 1;
        const tbody = document.getElementById("linkTableBody");
        const noDataRow = document.getElementById("noDataRow");
        const searchInput = document.getElementById("searchInput");

        function toggleMobileMenu() {
            const nav = document.getElementById('mainNavigation');
            nav.classList.toggle('active');
        }

        function sortTable(columnIndex, direction) {
            const collator = new Intl.Collator('th', { sensitivity: 'base' });
            allTableRows.sort((rowA, rowB) => {
                const cellA = rowA.getElementsByTagName("td")[columnIndex].querySelector('a') 
                              ? rowA.getElementsByTagName("td")[columnIndex].querySelector('a').textContent.trim() 
                              : rowA.getElementsByTagName("td")[columnIndex].textContent.trim();
                const cellB = rowB.getElementsByTagName("td")[columnIndex].querySelector('a')
                              ? rowB.getElementsByTagName("td")[columnIndex].querySelector('a').textContent.trim()
                              : rowB.getElementsByTagName("td")[columnIndex].textContent.trim();
                if (direction === 'asc') {
                    return collator.compare(cellA, cellB);
                } else {
                    return collator.compare(cellB, cellA);
                }
            });
            displayPage(currentPage);
        }

        function displayPage(page) {
            currentPage = page;
            const itemsPerPage = parseInt(document.getElementById("itemsPerPage").value);
            const filter = searchInput.value.toLowerCase();
            const filteredRows = allTableRows.filter(row => {
                const cells = row.getElementsByTagName("td");
                const textContent = Array.from(cells).map(cell => 
                    (cell.textContent || cell.innerText).toLowerCase()
                ).join(" ");
                return textContent.includes(filter);
            });

            tbody.innerHTML = ''; 

            if (filteredRows.length === 0) {
                if(noDataRow) {
                    noDataRow.style.display = '';
                    tbody.appendChild(noDataRow);
                }
                totalPages = 1;
                currentPage = 1;
            } else {
                if(noDataRow) noDataRow.style.display = 'none';
                totalPages = Math.ceil(filteredRows.length / itemsPerPage);
                if (page > totalPages) currentPage = totalPages;
                if (page < 1) currentPage = 1;
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage;
                const slicedRows = filteredRows.slice(startIndex, endIndex);
                slicedRows.forEach(row => { tbody.appendChild(row); });
            }

            document.getElementById("currentPage").textContent = currentPage;
            document.getElementById("totalPages").textContent = totalPages;
            document.getElementById("btnFirst").disabled = (currentPage === 1);
            document.getElementById("btnPrev").disabled = (currentPage === 1);
            document.getElementById("btnNext").disabled = (currentPage === totalPages);
            document.getElementById("btnLast").disabled = (currentPage === totalPages);
        }

        document.addEventListener('DOMContentLoaded', () => {
            allTableRows = Array.from(tbody.children).filter(row => row.id !== 'noDataRow');
            
            document.getElementById("btnFirst").addEventListener('click', () => displayPage(1));
            document.getElementById("btnPrev").addEventListener('click', () => displayPage(currentPage - 1));
            document.getElementById("btnNext").addEventListener('click', () => displayPage(currentPage + 1));
            document.getElementById("btnLast").addEventListener('click', () => displayPage(totalPages));
            document.getElementById("itemsPerPage").addEventListener('change', () => displayPage(1)); 
            searchInput.addEventListener('keyup', () => displayPage(1)); 

            displayPage(1);

            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                const nav = document.getElementById('mainNavigation');
                const toggle = document.querySelector('.mobile-menu-toggle');
                if (nav && nav.classList.contains('active') && !nav.contains(e.target) && !toggle.contains(e.target)) {
                    nav.classList.remove('active');
                }
            });
        });

        // 2. ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ Submit Form ‡∏à‡∏£‡∏¥‡∏á)
        document.querySelectorAll('.delete-form').forEach(form => {
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const currentForm = this;
                const row = currentForm.closest('tr');
                const linkName = row.querySelector('td:first-child').textContent.trim();
                
                Swal.fire({
                    title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
                    text: `‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏•‡∏¥‡∏á‡∏Ñ‡πå "${linkName}"?`,
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#dc3545',
                    cancelButtonColor: '#6c757d',
                    confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏•‡∏ö‡πÄ‡∏•‡∏¢!',
                    cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // ‡∏™‡∏±‡πà‡∏á Submit Form ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Backend ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
                        currentForm.submit(); 
                    }
                });
            });
        });
    </script>

    <script>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                const messages = {{ messages | tojson }};
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top', /* ‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô top-end */
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                });
                messages.forEach(([category, message]) => {
                    Toast.fire({
                        icon: category, // success, error, warning, info
                        title: message
                    });
                });
            {% endif %}
        {% endwith %}
    </script>
</body>
</html>